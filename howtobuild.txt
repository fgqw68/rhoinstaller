This document explains how to build Rhostudio installers for Windows and Mac OSX.



How to build in first time:

*** RhoStudio plugin ***

*** RhoStudio feature ***

*** Eclipse product ***

1. Download Eclipse 3.6 for RPC developer config
1.1 dltk
1.2 egit

2. clone Rhostudio repositary (git clone git@github.com:rhomobile/rhostudio.git)
  
3. Import RhoStudio project and Rhostudio feature project into workspace

   3.1 Goto File/Import menu item 
   3.2 Select General/Existing Project into Workspace
   3.3 Select repository directory 
   3.4 Finish   
   3.5 Import 

4. After import RhoStudio project you should see RhoStudio product item in project tree

5. Export product 

   5.1 Open product item 
   5.2 press export button in toolbar
   5.3 Uncheck 'Generate metadata repositary' item 
   5.4 Place destination directory 

6. Copy product files in directory with eclipse assambly <!!!>


*** How to build Rhostudio installer for Windows ***

1. Create empty directory for build process. It will be referred to as <root>. Path to <root> have to be free of spaces. This is requirement of Ruby which will be used during build process.

2. Download and install JDK (32-bit) (http://download.oracle.com/otn-pub/java/jdk/7u4-b20/jdk-7u4-windows-i586.exe).

3. Download and install Git (https://github.com/downloads/schacon/testy/Git-1.7.10-preview20120409.exe).
    On "Adjusting your PATH environment" page select "Run Git from the Windows Command Prompt".

4. Download and install NSIS (http://prdownloads.sourceforge.net/nsis/nsis-2.46-setup.exe?download).

5. Download NSIS large string patch (http://downloads.sourceforge.net/project/nsis/NSIS%202/2.46/nsis-2.46-strlen_8192.zip?r=http%3A%2F%2Fnsis.sourceforge.net%2FSpecial_Builds&ts=1319209736&use_mirror=citylan).
    Unpack patch and copy its content into NSIS installation directory (into 'C:\Program Files (x86)\NSIS' for example).

6. Download Eclipse 3.7 (Indigo) for RCP and RAP Developers (http://www.eclipse.org/downloads/download.php?file=/technology/epp/downloads/release/indigo/SR2/eclipse-rcp-indigo-SR2-win32-x86_64.zip).
    Extract downloaded Eclipse archive into <root> directory.
    Check new <root>\eclipse directory.

7. Download Ruby 1.9.3-p125 (http://rubyforge.org/frs/download.php/75848/rubyinstaller-1.9.3-p125.exe).
    Run ruby installer and install Ruby into <root>\ruby directory.
    Check new <root>\ruby directory.

8. Download installer package archive (http://rhostudio.s3.amazonaws.com/instant/work/installer.rar).
    Extract archive into <root> directory.
    Check new <root>\installer directory.
    Rename <root>\installer to <root>\rhoinstaller directory.
    From <root>\rhoinstaller directory run following commands:
        git checkout .
        git pull

9. Download Ruby DevKit (https://github.com/downloads/oneclick/rubyinstaller/DevKit-tdm-32-4.5.2-20111229-1559-sfx.exe).
    Remove <root>\rhoinstaller\package\devkit directory.
    Run it and extract to <root>\rhoinstaller\package\devkit directory.

10. Configure ruby. Open new console (cmd.exe) and execute there following commands:
    path <root>\ruby\bin
    cd <root>\rhoinstaller\package\devkit
    ruby dk.rb init
    ruby dk.rb install

11. Clone RhoStudio repository (git clone http://github.com/rhomobile/rhostudio.git) in <root> directory.

12. Download or build Rhodes and RhoElements gems.
    Create <root>\gems directory and place both gems into it.

13. Create Eclipse workspace and configure Eclipse.
    Run Eclipse with command (use absolute path as "-data" parameter):
        <root>\eclipse\eclipse -data <root>\workspace

    From menu select "Help"->"Install new software...".
    Press "Add...".
    Enter "DLTK" as name and "http://download.eclipse.org/technology/dltk/updates/" as location, press "OK".
    Wait until list will be populated with values, then mark "Dynamic Languages Toolkit (DLTK) 2.0" and press "Next >".
    Press "Next >" again.
    Accept license and press "Finish".

    Wait for finish of installation. Restart Eclipse from "Software Updates" dialog.
     
    From menu select "File"->"Import...".
    In list of import sources select "General"->"Existing Projects into Workspace", then press "Next >".
    Press "Browse...".
    Select <root>\rhostudio directory, press "OK".
    Press "Finish".

    From menu select "Window"->"Show view"->"Problems".
    Expand "Error" in view, open context menu for any error, select "Quick Fix".
    Press "Finish".
    Press "OK".

    Delete all errors from Problems view.
    
    From menu select "Project"->"Clean...".
    Press "OK".
    Check that there are no errors after clean (warnings only).

    Close Eclipse.

15. Configure <root>\rhoinstaller\script\Rakefile file. You can tune following vsriables:
    $version                  = '2.0.0'
    $betaVersion              = '5.24'
    $isRhoconnectBeta         = true
    $isRhoconnectAdaptersBeta = false
    $isMotorolaBeta           = true
    $nsisPath                 = "C:/Program Files (x86)/NSIS/makensis.exe"

16. Open new console (cmd.exe) and execute following commands:
    PATH <root>\ruby\bin;C:\Windows\system32
    cd <root>\rhoinstaller\script
    rake installer:motorola

17. Wait while script finishes. New installer is created in <root> directory.


*** OSX installer ***

1. Download base DMG image (link - http://rhostudio.s3.amazonaws.com/instant/work/RhoMobileSuiteInstaller.dmg)

2. Mount image in system

3. Put rhodes and rhoelements gems in '.gems' subfolder on the image

4. Change gems names in 'Install gems' and 'Install gems on rvm' scripts

5. Make new version of RhoStudio plugin and put it in 'Motorola RhoStudio/plugins' subfolder

6. Update samples/rhodes-system-api-samples (git clone https://github.com/rhomobile/rhodes-system-api-samples.git).
    Remove .git* entries afterwards.

7. Update 'RhoElements2 Shared Runtime', RhoElements2 directories content, README.html file from rhoelements gem.

8. Hide side bar, "maximize" Finder window to fit content and close it.

9. Unmount image.

10. Open the image in disk utility and convert to 'read only' image with compressed content.
    There is sample of new image name: 'RhoMobileSuiteInstaller2.0.0.beta5.24.dmg'
